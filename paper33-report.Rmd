---
title: "Paper 33 Reproducibility Report"
author: "Ben Bond-Lamberty"
date: "`r format(Sys.time(), '%d %B %Y')`"
bibliography: bibliography.bib
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Guidelines: https://github.com/ReScience/ten-years/blob/master/author-guidelines.md

What to put inside the RR: https://github.com/ReScience/ten-years/issues/4

### Historical context

Significant changes in forest fires have occurred in recent decades in the global boreal (high latitude) forest, but the effects of changing climate and disturbance on evapotranspiration (ET) and forest water cycling more generally are not well understood. In a previous study [@Bond-Lamberty2007-uq] we had explored the ecological and carbon-cycle consequences of changes in the fire regime using an ecosystem model run at high resolution across a large (1000 km x 1000 km) area of the central Canadian boreal forest. In a subsequent paper [@Bond-Lamberty2009-py], we used the same model outputs to examine the _hydrological_ implications of these wildfire regime shifts.

The article manuscript was written in 2007-2008, initially submitted in April 2008, and a final, revised version was submitted in October of that year. The system timestamp on the script output file is 2008-03-16. The methods section of Bond-Lamberty et al. [-@Bond-Lamberty2009-py] says that R 2.6.0, which was released on 2007-10-03, was used for all analyses. The source code was not publicly archived, but retained in the lead author's personal records; it has no license. The original hardware would have been an Apple laptop (probably a 2006-2007 MacBook Pro). As noted above, the code file was archived by the lead author, and so was easy for him (but no one else) to find. The code has no comments or instructions.

### Retrieval of the software

The source code being reproduced here is short and was written to analyze relationships between various potential driving factors and three output variables of interest: ET, canopy evaporation, and canopy transpiration, all annual flux totals over the 1948-2005 model run period. The code simply reads in a comma-separated data file holding the modeling outputs, prints a summary of the data, and then fits and prints 12 separate regressions (three output variables times four possible independent variables). These fit statistics were reported on p. 1247 of Bond-Lamberty et al. [-@Bond-Lamberty2009-py].

### Execution

Because the code uses only base R functions, it has no dependencies other than a standard R installation. Both in 2007-2008 and 2020, the default Mac R installer provided by CRAN was used to install R (i.e. it was not built from source). The code was re-run, without modification, on a 2018 MacBook Pro under R version 3.6.1 (2019-07-05); platform: x86_64-apple-darwin15.6.0 (64-bit); running under macOS Mojave 10.14.6.

Setting aside minor spacing and text capitalization changes, only one numerical change occurred, albeit in the sixth decimal place. In the 2008 R 2.6.0 output of a linear regression between canopy evaporation (dependent variable) and precipitation (independent), the residuals were given as:
```
Residuals:
      Min        1Q    Median        3Q       Max 
-0.028858 -0.009186  0.002088  0.010753  0.019997 
```
In the 2020 R 3.6.0 output, this line (specifically, the "Median" value) was:
```
Residuals:
      Min        1Q    Median        3Q       Max 
-0.028858 -0.009186  0.002089  0.010753  0.019997 
```
In addition, in two cases p-values were reported with a different number of significant digits in the 2020 output: once gaining a digit ("0.005451" in 2020 versus "0.00545" in 2008) and once losing one ("0.000103" and 0.0001030" respectively). No other numerical differences occurred.

Were these minor differences due to the different R version, or different underlying operating system and/or libraries? I downloaded R version 2.6.0 from https://cran.r-project.org, specifically https://cran.r-project.org/bin/macosx/old/R-2.6.0.dmg, and installed it on a second but very similar test machine, a TODO.

### Conclusions

As simple as the code and this reproducibility exercise was, there are some interesting notes that can be drawn from it. Reproducibility has been a core value of the R Core Team, and the base version of the software has been highly stable over the last twenty years since version 1.0. Specifically for this exercise, the core of the `lm` (linear model) source code, found at https://svn.r-project.org/R/trunk/src/library/stats/R/lm.R, has changed little over the last decade.

In contrast, many of the most highly used R packages, for example those of the popular tidyverse ecosystem (https://www.tidyverse.org) have historically changed their behavior and syntax much more frequently. This allows for faster evolution and cleaner, consistent syntax (not among base R's strong points) but poses greater challenges for stable and reproducible software. For example, the popular `dplyr` package lists (see https://github.com/tidyverse/dplyr/blob/master/NEWS.md) breaking changes introduced at versions 0.5, 0.7, 0.7.5, 0.8, 0.8.1, and 1.0, over a timespan of four years; it seems unlikely that code taking advantage of its powerful features and speed would be reproducible without being tweaked or rewritten. This highlights some of the challenges surrounding computational reproducibility [@Thornton2005-hw; @Lowndes2017-el].

With regard to the very short length of code that was needed to be re-run for this report, the script contained no documentation about R or package versions, hardware information, or dates. These are all obvious shortcomings. Critically for reproducibility, however, its _printed output_, recorded via R's `sink()` function, was saved in an accompanying file (one with an unaltered file timestamp). This allowed for a robust check on the reproducibility of the analysis, script, and underlying R software after 12 years.

### References
